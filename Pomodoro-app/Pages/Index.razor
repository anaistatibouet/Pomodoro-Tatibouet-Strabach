@page "/"
@using System.Threading;
@using Data;
@using System;

<h1>Projet Pomodoro</h1>
<p>Gérez son temps comme il faut</p>

<div>
    <h2>Travail Pomodoro</h2>
    <p>@timeElapsed</p>
</div>

<button class="btn btn-outline-success" @onclick="Start"><span class="oi oi-play-circle"></span> Démarrer</button>
<button class="btn btn-outline-dark" @onclick="Stop"><span class="oi oi-media-pause"></span> Pause</button>
<button class="btn btn-outline-warning" @onclick="Reset"><span class="oi oi-action-undo"></span> Réinitialiser</button>

@code {
    public Pomodoro currentPomodoro = new Pomodoro();
    private double timeElapsed { get; set; }
    private string timeElapsedString { get; set;  }

    public void Start()
    {
        currentPomodoro.StartPomodoro();
    }

    public void Stop()
    {
        currentPomodoro.StopPomodoro();
    }

    public void Reset()
    {
        currentPomodoro.ResetPomodoro();
    }

    public void TimeElapsed()
    {
        timeElapsed = currentPomodoro.TimeElapsed();
    }

    protected override void OnInitialized()
    {
        // Permet de rafraîchir le pomodoro
        var timer = new Timer(new TimerCallback(_ =>
        {
            TimeElapsed();

            InvokeAsync(() =>
            {
                StateHasChanged();
            });

        }), null, 1000, 1000);
    }
}

